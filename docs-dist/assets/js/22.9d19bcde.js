(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{225:function(e,a,n){"use strict";n.r(a);var s=n(3),r=Object(s.a)({},(function(){var e=this,a=e.$createElement,n=e._self._c||a;return n("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[n("h3",{attrs:{id:"boucler-sur-les-champs-de-ligne-en-awk"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#boucler-sur-les-champs-de-ligne-en-awk"}},[e._v("#")]),e._v(" "),n("a",{attrs:{href:"http://www.ixany.org/2014/11/01/Boucler-sur-les-champs-de-ligne-en-awk.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Boucler sur les champs de ligne en awk"),n("OutboundLink")],1)]),e._v(" "),n("p",[e._v("Ã‰tiquettes : shel, awk. Ã‰crit le 01/11/2014.")]),e._v(" "),n("p",[e._v("SousÂ "),n("em",[e._v("awk")]),e._v(", si on veut effectuer une boucle sur un nombre variable de champs dâ€™une ligne, il suffit de se rappeler que le nombre de champs dâ€™une ligne est conservÃ© dans la variableÂ "),n("code",[e._v("NF")]),e._v(", et que la valeur dâ€™un champ peut Ãªtre lu en prÃ©fixant une variable numÃ©rique parÂ "),n("code",[e._v("$")]),e._v("Â (donc, si la variableÂ "),n("code",[e._v("i")]),e._v("Â vautÂ "),n("em",[e._v("3")]),e._v(", alorsÂ "),n("code",[e._v("$i")]),e._v("Â est Ã©quivalent Ã Â "),n("code",[e._v("$3")]),e._v("Â et donne la valeur du troisiÃ¨me champ de la ligne en cours).")]),e._v(" "),n("p",[e._v("Voici par exemple un fichier contenant une liste dâ€™utilisateurs dont le nom est donnÃ© dans le premier champ de chaque ligne, suivi dâ€™un nombre variable dâ€™entiers (dÃ©signant par exemple des numÃ©ro de loto quâ€™il a reÃ§u)Â :")]),e._v(" "),n("div",{staticClass:"language-bash extra-class"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[e._v("$ "),n("span",{pre:!0,attrs:{class:"token function"}},[e._v("cat")]),e._v(" loto.txt\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# PrÃ©nom liste_des_numÃ©ros")]),e._v("\nPhilip "),n("span",{pre:!0,attrs:{class:"token number"}},[e._v("2")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[e._v("65")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[e._v("12")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[e._v("96")]),e._v("\nTuranga "),n("span",{pre:!0,attrs:{class:"token number"}},[e._v("55")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[e._v("34")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[e._v("82")]),e._v("\nHubert "),n("span",{pre:!0,attrs:{class:"token number"}},[e._v("23")]),e._v("\nAmy "),n("span",{pre:!0,attrs:{class:"token number"}},[e._v("44")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[e._v("12")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[e._v("9")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[e._v("24")]),e._v("\nHermes "),n("span",{pre:!0,attrs:{class:"token number"}},[e._v("32")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[e._v("99")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[e._v("8")]),e._v("\n")])])]),n("p",[e._v("Le petit programme awk appelÃ© dâ€™un shell ci-dessous parcourt le fichierÂ "),n("em",[e._v("loto.txt")]),e._v("Â et affiche une ligne par numÃ©ro attribuÃ© Ã  une personne (les lignes commenÃ§ant parÂ "),n("code",[e._v("#")]),e._v("Â sont ignorÃ©es)Â :")]),e._v(" "),n("div",{staticClass:"language-bash extra-class"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[e._v("$ "),n("span",{pre:!0,attrs:{class:"token function"}},[e._v("awk")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[e._v("'\n  /^#/ { next }\n  {\n      for (i=2; i<=NF; i++) {\n          printf \"%s a reÃ§u le numÃ©ro %d"),n("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[e._v("\\n")]),e._v('", '),n("span",{pre:!0,attrs:{class:"token variable"}},[e._v("$1")]),e._v(", "),n("span",{pre:!0,attrs:{class:"token variable"}},[e._v("$i")]),e._v("\n      }\n  }\n  '")]),e._v(" loto.txt\nPhilip a reÃ§u le numÃ©ro "),n("span",{pre:!0,attrs:{class:"token number"}},[e._v("65")]),e._v("\nPhilip a reÃ§u le numÃ©ro "),n("span",{pre:!0,attrs:{class:"token number"}},[e._v("12")]),e._v("\nPhilip a reÃ§u le numÃ©ro "),n("span",{pre:!0,attrs:{class:"token number"}},[e._v("96")]),e._v("\nTuranga a reÃ§u le numÃ©ro "),n("span",{pre:!0,attrs:{class:"token number"}},[e._v("55")]),e._v("\nTuranga a reÃ§u le numÃ©ro "),n("span",{pre:!0,attrs:{class:"token number"}},[e._v("34")]),e._v("\nTuranga a reÃ§u le numÃ©ro "),n("span",{pre:!0,attrs:{class:"token number"}},[e._v("82")]),e._v("\nHubert a reÃ§u le numÃ©ro "),n("span",{pre:!0,attrs:{class:"token number"}},[e._v("23")]),e._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("..")]),e._v(".\n")])])]),n("h3",{attrs:{id:"parcourir-les-parametres-positionnels-d-un-script-shell-dans-les-deux-sens"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#parcourir-les-parametres-positionnels-d-un-script-shell-dans-les-deux-sens"}},[e._v("#")]),e._v(" "),n("a",{attrs:{href:"http://www.ixany.org/2014/10/19/Parcourir-les-parametres-d-un-script-shell.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Parcourir les paramÃ¨tres positionnels d'un script shell... dans les deux sens"),n("OutboundLink")],1)]),e._v(" "),n("p",[e._v("Ã‰tiquettes : shell, bash. Ã‰crit le 19/10/2014.")]),e._v(" "),n("p",[e._v("Pour traiter un Ã  un les paramÃ¨tres positionnels passÃ©s Ã  un script ou une fonction shell, on utilise simplement une boucleÂ "),n("code",[e._v("for")]),e._v("Â de ce genreÂ :")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('for arg\ndo\n    # faire quelque chose avec $arg\n    echo "argument $arg";\ndone\n')])])]),n("p",[e._v("UtilisÃ© sans clause Â«Â "),n("code",[e._v("in ...")]),e._v("Â Â»,Â "),n("code",[e._v("for")]),e._v("Â effectue une boucle sur tous les paramÃ¨tres positionnels, ce qui revient donc au mÃªme que dâ€™utiliser Â«Â "),n("code",[e._v("for arg in $@")]),e._v("Â Â».")]),e._v(" "),n("p",[e._v("Mais parcourir la liste de ces paramÃ¨tresÂ "),n("em",[e._v("Ã  lâ€™envers")]),e._v("Â nâ€™est pas beaucoup plus difficile, grÃ¢ce Ã  une petite astuceÂ :")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('for i in $(seq $# -1 1)\ndo\n    arg=${!i}\n    # faire quelque chose avec $arg\n    echo "argument $arg";\ndone\n')])])]),n("p",[n("code",[e._v("for")]),e._v("Â boucle ici sur les numÃ©ros de paramÃ¨tres quâ€™on veut traiter, du dernier paramÃ¨tre, donnÃ© par la variableÂ "),n("code",[e._v("$#")]),e._v(", au premier, numÃ©rotÃ©Â "),n("code",[e._v("1")]),e._v("Â ("),n("code",[e._v("$0")]),e._v("Â nâ€™est pas un paramÃ¨tre, mais le nom du script).")]),e._v(" "),n("blockquote",[n("p",[n("em",[e._v("Note")]),e._v("Â : on a recours Ã  la commandeÂ "),n("code",[e._v("seq")]),e._v("Â car le gÃ©nÃ©rateur de sÃ©rie interne Ã  bash (du typeÂ "),n("code",[e._v("{10..1}")]),e._v(") utilise les accolades qui sont Ã©valuÃ©esÂ "),n("em",[e._v("avant")]),e._v("Â le remplacement des variables. On ne peut doncÂ "),n("strong",[e._v("pas")]),e._v("Â Ã©crire quelque chose comme Â«Â "),n("code",[e._v("{$#..1}")]),e._v("Â Â».")])]),e._v(" "),n("p",[e._v("Ensuite, pour lire la valeur du paramÃ¨tre positionnel (contenue dansÂ "),n("code",[e._v("$4")]),e._v(",Â "),n("code",[e._v("$3")]),e._v(", â€¦), on introduit un niveau dâ€™imbrication de variable grÃ¢ce au point dâ€™exclamationÂ : il indique quâ€™on veut lire la valeur dâ€™une variable dont le nom est contenu dans une autre variable.")]),e._v(" "),n("p",[e._v("Ainsi, siÂ "),n("code",[e._v("$i")]),e._v("Â contientÂ "),n("code",[e._v("3")]),e._v(",Â "),n("code",[e._v("${!i}")]),e._v("Â sera remplacÃ© par la valeur de la variableÂ "),n("code",[e._v("$3")]),e._v(", donc le troisiÃ¨me argument positionnel du script ou de la fonction. Et Ã§a tombe plutÃ´t bien, câ€™est ce quâ€™on voulaitÂ !")]),e._v(" "),n("blockquote",[n("p",[n("em",[e._v("Corolaire")]),e._v("Â :Â "),n("em",[e._v("le dernier paramÃ¨tre")]),e._v("Â dâ€™un script peut donc Ãªtre lu directement grÃ¢ce Ã  lâ€™expression Â«Â "),n("code",[e._v("${!#}")]),e._v("Â Â» dont lâ€™explication ne peut plus vous Ã©chapperÂ ğŸ˜ƒ")])]),e._v(" "),n("p",[e._v("Et si vous voulez boucler sur un sous-ensemble des paramÃ¨tres positionnels, voir mon astuce Â«Â "),n("a",{attrs:{href:"http://www.ixany.org/2014/10/16/Acceder-aux-arguments-du-script-shell.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("AccÃ©der facilement aux arguments dâ€™un script shell"),n("OutboundLink")],1),e._v("Â Â».")]),e._v(" "),n("h3",{attrs:{id:"acceder-facilement-aux-arguments-d-un-script-shell"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#acceder-facilement-aux-arguments-d-un-script-shell"}},[e._v("#")]),e._v(" "),n("a",{attrs:{href:"http://www.ixany.org/2014/10/16/Acceder-aux-arguments-du-script-shell.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("AccÃ©der facilement aux arguments d'un script shell"),n("OutboundLink")],1)]),e._v(" "),n("p",[e._v("Ã‰tiquettes : shell, bash. Ã‰crit le 16/10/2014.")]),e._v(" "),n("p",[e._v("Dans un script ou une fonction shell, on a souvent besoin dâ€™accÃ©der aux arguments qui lui ont Ã©tÃ© passÃ©s. Câ€™est simple quand on connaÃ®t prÃ©cisÃ©ment son indice dans la liste des arguments, grÃ¢ce aux paramÃ¨tres positionnelsÂ "),n("code",[e._v("$1")]),e._v(",Â "),n("code",[e._v("$2")]),e._v(", â€¦,Â "),n("code",[e._v("$n")]),e._v(".")]),e._v(" "),n("p",[e._v("Mais il est Ã©galement possible dâ€™accÃ©der Ã  un paramÃ¨tre dont on connaÃ®t la position depuisÂ "),n("em",[e._v("la fin")]),e._v("Â de la liste des paramÃ¨tresÂ :")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("$ function f() {\n    echo \"mon avant-dernier paramÃ¨tre est '${@: -2:1}'\"\n}\n$ f un deux trois    \nmon avant-dernier paramÃ¨tre est 'deux'\n")])])]),n("blockquote",[n("p",[n("em",[e._v("Attention")]),e._v("Â : il ne faut pas oublier de placer une espace entre le deux-points et le tiret, pour Ã©viter que bash ne confonde avec Â«Â "),n("code",[e._v(":-")]),e._v("Â Â» qui reprÃ©sente lâ€™utilisation de valeur par dÃ©faut.")])]),e._v(" "),n("p",[e._v("On peut Ã©galement rÃ©cupÃ©rer, par exemple, une liste de deux paramÃ¨tres avec quelque chose commeÂ "),n("code",[e._v("${@:2:2}")]),e._v("Â ouÂ "),n("code",[e._v("${@: -4:2}")]),e._v(", les cinq derniers avecÂ "),n("code",[e._v("${@: -5}")]),e._v(", ou encore le dernier argument avecÂ "),n("code",[e._v("${@: -1}")]),e._v(".")]),e._v(" "),n("p",[e._v("Pour plus de dÃ©tails sur les expressions du typeÂ "),n("code",[e._v("${paramÃ¨tre:dÃ©but:longueur}")]),e._v(", voir ma documentation sur laÂ "),n("a",{attrs:{href:"http://www.ixany.org/docs/Shell_Manipulation_chaines_et_tableaux_en_bash.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("manipulation des chaÃ®nes de caractÃ¨res et des tableaux en bash"),n("OutboundLink")],1),e._v(".")]),e._v(" "),n("h3",{attrs:{id:"limiter-rsync-a-un-repertoire"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#limiter-rsync-a-un-repertoire"}},[e._v("#")]),e._v(" "),n("a",{attrs:{href:"http://www.ixany.org/2014/10/14/Limiter-rsync-a-un-repertoire.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Limiter rsync Ã  un rÃ©pertoire"),n("OutboundLink")],1)]),e._v(" "),n("p",[e._v("Ã‰tiquettes : rsync, shell, GNU. Ã‰crit le 14/10/2014.")]),e._v(" "),n("p",[e._v("Lors de la mise en place de synchronisations automatisÃ©es des donnÃ©es Ã  lâ€™aide deÂ "),n("a",{attrs:{href:"http://manpages.debian.org/cgi-bin/man.cgi?query=rsync&apropos=0&sektion=0&manpath=Debian+7.0+wheezy&format=ascii&locale=en",target:"_blank",rel:"noopener noreferrer"}},[e._v("rsync"),n("OutboundLink")],1),e._v(", il est souvent souhaitable de limiter ses accÃ¨s Ã  un rÃ©pertoire particulier, parfois mÃªme en lecture seule.")]),e._v(" "),n("p",[e._v("Câ€™est possible lors de lâ€™utilisation dâ€™un daemonÂ "),n("em",[e._v("rsyncd")]),e._v(", mais cette solution ne permet pas le chiffrement des donnÃ©es lors de leur transfert sur le rÃ©seau. Lâ€™utilisation deÂ "),n("em",[e._v("rsync sur ssh")]),e._v("Â rÃ©soud ce problÃ¨me, mais ne permet pas de bÃ©nÃ©ficier des fonctionnalitÃ©s deÂ "),n("em",[e._v("rsyncd")]),e._v(".")]),e._v(" "),n("p",[e._v("Le script perl Â«Â "),n("em",[e._v("rrsync")]),e._v("Â Â» fourni avecÂ "),n("em",[e._v("rsync")]),e._v("Â permet heureusement de retrouver ces fonctionnalitÃ©s avec rsync sur ssh.")]),e._v(" "),n("p",[e._v("Cette solution sâ€™appuie sur la possibilitÃ© quâ€™offreÂ "),n("em",[e._v("openssh")]),e._v("Â de forcer lâ€™exÃ©cution dâ€™un script lors de lâ€™utilisation dâ€™une clef ssh. Ce script ayant accÃ¨s Ã  la commande originale envoyÃ©e par le programeÂ "),n("em",[e._v("rsync")]),e._v("Â distant, il peut la contrÃ´ler avant de lâ€™exÃ©cuter ou non (voirÂ "),n("a",{attrs:{href:"http://www.ixany.org/docs/OpenSSH_limiter_une_clef_ssh.html#command",target:"_blank",rel:"noopener noreferrer"}},[e._v("ma documentation sur les options associÃ©es Ã  une clef ssh"),n("OutboundLink")],1),e._v(").")]),e._v(" "),n("p",[e._v("En pratique, il faut donc gÃ©nÃ©rer une clef ssh dÃ©diÃ©e Ã  ces synchronisations de donnÃ©es sur la machine qui initie le transfertÂ "),n("em",[e._v("rsync")]),e._v("Â (iciÂ "),n("em",[e._v("machine1")]),e._v("), et la copier sur la machine oÃ¹ se trouvent les donnÃ©es dâ€™origine ("),n("em",[e._v("machine2")]),e._v(")Â :")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("machine1$ ssh-keygen -f ~/.ssh/id_sauvegardes\nmachine1$ ssh-copy-id -i ~/.ssh/id_sauvegardes monutilisateur@machine2\n")])])]),n("p",[e._v("On configure ensuiteÂ "),n("em",[e._v("machine2")]),e._v("Â pour forcer lâ€™utilisation deÂ "),n("em",[e._v("rrsync")]),e._v("Â lors des connexions utilisant cette clef en modifiant la ligne ajoutÃ©e parÂ "),n("em",[e._v("ssh-copy-id")]),e._v("Â dans le fichierÂ "),n("em",[e._v("~/.ssh/config")]),e._v(", pour y prÃ©ciser lâ€™option Â«Â "),n("em",[e._v("command")]),e._v("Â Â» (sur la mÃªme ligne, juste avant le type de la clef)Â :")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('machine2$ editor ~/.ssh/authorized_keys\n...\ncommand="rrsync -ro /srv/results" ssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAIEAmkHG1WCjC...\n')])])]),n("p",[n("code",[e._v("/srv/results")]),e._v("Â est ici le rÃ©pertoire contenant les donnÃ©es auxquellesÂ "),n("em",[e._v("machine1")]),e._v("Â aura accÃ¨s. Lâ€™optionÂ "),n("code",[e._v("-ro")]),e._v("Â est facultative et nâ€™autorisera que les accÃ¨s en lecture aux donnÃ©es (câ€™est Ã  dire les transfertsÂ "),n("em",[e._v("rsync")]),e._v("Â dans lesquelsÂ "),n("em",[e._v("machine2")]),e._v("Â est lâ€™expÃ©diteur, donc oÃ¹Â "),n("em",[e._v("rsync")]),e._v("Â y est invoquÃ©e Ã  distance avec lâ€™option interneÂ "),n("code",[e._v("--sender")]),e._v(").")]),e._v(" "),n("p",[e._v("Le lancement du transfertÂ "),n("em",[e._v("rsync")]),e._v("Â se fait comme dâ€™habitude surÂ "),n("em",[e._v("machine1")]),e._v(", par exemple avec la commandeÂ :")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("machine1$ rsync -e 'ssh -i ~/.ssh/id_sauvegardes' /srv/results/job0/ /srv/jobs/job0\n")])])]),n("p",[e._v("Lâ€™optionÂ "),n("code",[e._v("-e")]),e._v("Â nâ€™est utile que pour fournir lâ€™optionÂ "),n("code",[e._v("-i")]),e._v("Â au clientÂ "),n("em",[e._v("openssh")]),e._v("Â indiquant la clef Ã  utiliser, mais cela peut aussi bien se faire Ã  lâ€™aide du fichierÂ "),n("em",[e._v("~/.ssh/config")]),e._v(".")]),e._v(" "),n("p",[e._v("Sous Debian GNU/Linux, le script perlÂ "),n("em",[e._v("rrsync")]),e._v("Â est fourni avec le paquetÂ "),n("em",[e._v("rsync")]),e._v(", mais seulement Ã  titre dâ€™exemple. Vous devrez donc dâ€™abord lâ€™installer dans un rÃ©pertoire des commandes du systÃ¨me. Par exemple, siÂ "),n("em",[e._v("/usr/local/bin")]),e._v("Â est bien contenu dans la variableÂ "),n("em",[e._v("$PATH")]),e._v("Â :")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("gzip -c /usr/share/doc/rsync/scripts/rrsync.gz > /usr/local/bin/rrsync\nchmod 755 /usr/local/bin/rrsync\n")])])]),n("p",[e._v("Lisez les commentaires du scriptÂ "),n("em",[e._v("rrsync")]),e._v("Â pour plus dâ€™information sur son fonctionnement. Pour les dÃ©tails sur les options associÃ©es aux clef ssh dans le fichierÂ "),n("em",[e._v("~/.ssh/config")]),e._v(", voirÂ "),n("a",{attrs:{href:"http://manpages.debian.org/cgi-bin/man.cgi?query=sshd&apropos=0&sektion=0&manpath=Debian+7.0+wheezy&format=ascii&locale=en",target:"_blank",rel:"noopener noreferrer"}},[e._v("la page de manuel de sshd(8)"),n("OutboundLink")],1),e._v(", dans sa section Â«Â "),n("em",[e._v("AUTHORIZED_KEYS FILE FORMAT")]),e._v("Â Â», ouÂ "),n("a",{attrs:{href:"http://www.ixany.org/docs/OpenSSH_limiter_une_clef_ssh.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("ma documentation sur les options associÃ©es Ã  une clef ssh"),n("OutboundLink")],1),e._v(".")]),e._v(" "),n("h3",{attrs:{id:"la-commande-gnu-date"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#la-commande-gnu-date"}},[e._v("#")]),e._v(" "),n("a",{attrs:{href:"http://www.ixany.org/2014/10/04/La-commande-gnu-date.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("La commande GNU date"),n("OutboundLink")],1)]),e._v(" "),n("p",[e._v("Ã‰tiquettes : shell, GNU. Ã‰crit le 04/10/2014.")]),e._v(" "),n("p",[e._v("Vous connaissez probablement dÃ©jÃ  les nombreux formats de date et dâ€™heure selon lesquels la commandeÂ "),n("a",{attrs:{href:"http://www.gnu.org/",target:"_blank",rel:"noopener noreferrer"}},[e._v("GNU"),n("OutboundLink")],1),e._v("Â date peut afficher ses informations.Â "),n("a",{attrs:{href:"http://manpages.debian.org/cgi-bin/man.cgi?query=date&apropos=0&sektion=0&manpath=Debian+7.0+wheezy&format=html&locale=fr",target:"_blank",rel:"noopener noreferrer"}},[e._v("La page de manuel de date(1)"),n("OutboundLink")],1),e._v("Â nous renseigne sur ces nombreux formats, dÃ©signÃ©s de faÃ§on similaire Ã  ce que fait Â«Â printfÂ Â» ("),n("a",{attrs:{href:"http://manpages.debian.org/cgi-bin/man.cgi?query=printf&sektion=3&apropos=0&manpath=Debian+7.0+wheezy&locale=fr",target:"_blank",rel:"noopener noreferrer"}},[e._v("la fonction du langage C"),n("OutboundLink")],1),e._v(", ouÂ "),n("a",{attrs:{href:"http://manpages.debian.org/cgi-bin/man.cgi?query=printf&apropos=0&sektion=0&manpath=Debian+7.0+wheezy&format=html&locale=fr",target:"_blank",rel:"noopener noreferrer"}},[e._v("la commande du shell"),n("OutboundLink")],1),e._v("), dans une chaÃ®ne de caractÃ¨res commenÃ§ant par Â«Â +Â Â». En voici un exempleÂ :")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("$ date +\"Le %A %e %B %Y Ã  %R (le %j iÃ¨me jour de l'annÃ©e)\".\nLe samedi  4 octobre 2014 Ã  18:15 (le 277 iÃ¨me jour de l'annÃ©e).\n")])])]),n("p",[e._v("Mais une fonctionnalitÃ© beaucoup moins connue deÂ "),n("em",[e._v("date")]),e._v("Â en fait une commande particuliÃ¨rement puissante. Elle nâ€™est pourtant Ã©voquÃ©e que trÃ¨s discrÃ¨tement dansÂ "),n("a",{attrs:{href:"http://manpages.debian.org/cgi-bin/man.cgi?query=date&apropos=0&sektion=0&manpath=Debian+7.0+wheezy&format=html&locale=fr",target:"_blank",rel:"noopener noreferrer"}},[e._v("sa page de manuel"),n("OutboundLink")],1),e._v(", on peut donc facilement passer Ã  cÃ´tÃ©Â : il sâ€™agit de lâ€™option Â«Â -dÂ Â», et plus prÃ©cisÃ©ment la faÃ§on dont on peut dÃ©signer la date Ã  afficher.")]),e._v(" "),n("p",[e._v("On peut prÃ©ciser cette date ou cette heure de faÃ§on absolue, comme Â«Â 1914-07-28 06:00Â Â» ou Â«Â 28 July 1914 17:00Â Â» (seuls les noms en anglais sont reconnus)Â :")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("$ date -d '1914-07-28 06:00'\nmardi 28 juillet 1914, 06:00:00 (UTC+0200)\n$ date -d '28 July 1914 06:00:00'\nmardi 28 juillet 1914, 06:00:00 (UTC+0200)\n")])])]),n("p",[e._v("Mais ce qui est particuliÃ¨rement pratique, câ€™est de la dÃ©signer de faÃ§on relative Ã  lâ€™heure actuelle ou Ã  une date fournieÂ :")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("$ date -d 'yesterday'\nvendredi 3 octobre 2014, 18:15:37 (UTC+0200)\n$ date -d '2 days ago'\njeudi 2 octobre 2014, 18:15:42 (UTC+0200)\n$ date -d 'last monday'\nlundi 29 septembre 2014, 00:00:00 (UTC+0200)\n$ date -d '1918-11-11 - 4 years'\nmercredi 11 novembre 1914, 00:00:00 (UTC+0200)\n$ date -d '2000-01-01 - 1 day'\nvendredi 31 dÃ©cembre 1999, 00:00:00 (UTC+0200)\n")])])]),n("p",[e._v("Les formats dâ€™entrÃ©e de date sont documentÃ©s dans la pageÂ "),n("em",[e._v("info")]),e._v("Â de dateÂ : lancez la commandeÂ "),n("em",[e._v("info date")]),e._v(", et suivez le lien Â«Â "),n("em",[e._v("Date input formats::")]),e._v("Â Â» (placer le curseur dessus et tapez Â«Â EntrÃ©eÂ Â»). Cette page donne des liens vers tous les formats acceptÃ©s pour prÃ©ciser la date Ã  afficher; pour les informations sur les dates relatives, suivre le lien Â«Â "),n("em",[e._v("Relative items in date strings::")]),e._v("Â Â».")]),e._v(" "),n("p",[e._v("Attention toutefois Ã  quelques subtilitÃ©sÂ : comme le prÃ©cise la documentation, le terme Â«Â last monthÂ Â» Ã©quivaut Ã  Â«Â - 30 daysÂ Â». Il faut donc prendre garde lorsquâ€™on lâ€™utilise le dernier jour du moisÂ :")]),e._v(" "),n("div",{staticClass:"language-bash extra-class"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[e._v("~$ "),n("span",{pre:!0,attrs:{class:"token function"}},[e._v("date")]),e._v(" -d "),n("span",{pre:!0,attrs:{class:"token string"}},[e._v('"2014-10-31 last month"')]),e._v("\nmercredi "),n("span",{pre:!0,attrs:{class:"token number"}},[e._v("1")]),e._v(" octobre "),n("span",{pre:!0,attrs:{class:"token number"}},[e._v("2014")]),e._v(", 00:00:00 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("UTC+0200"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n")])])]),n("p",[e._v("Pour obtenir le nom du mois prÃ©cÃ©dent, il faut prÃ©ciser un jour du mois qui ne posera pas de problÃ¨meÂ :")]),e._v(" "),n("div",{staticClass:"language-bash extra-class"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[e._v("$ "),n("span",{pre:!0,attrs:{class:"token function"}},[e._v("date")]),e._v(" -d "),n("span",{pre:!0,attrs:{class:"token string"}},[e._v('"2014-10-01 last month"')]),e._v(" +%B\nseptembre\n")])])]),n("p",[e._v("En complÃ©ment, pour obtenir lâ€™heure dans un autre fuseau horaire, il suffit de changer la variable dâ€™environnementÂ "),n("em",[e._v("TZ")]),e._v(", soit pour tout le shell (via la commandeÂ "),n("em",[e._v("export TZ=â€¦")]),e._v("), soit uniquement pour une commande.")]),e._v(" "),n("p",[e._v("Quelle heure est-il actuellement Ã  Hong-KongÂ :")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('$ TZ="Asia/Hong_Kong" date\ndimanche 5 octobre 2014, 00:37:00 (UTC+0800)\n')])])]),n("p",[e._v("Mieux encore, comme le montre la documentation de la commande, on peut prÃ©ciser le fuseau horaire de la date quâ€™on veut afficher, donc demander par exemple quelle heure il est Ã  Hong-Kong quand il est 18h40 Ã  Port-au-PrinceÂ :")]),e._v(" "),n("div",{staticClass:"language-bash extra-class"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[e._v("$ "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("TZ")]),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[e._v('"Asia/Hong_Kong"')]),e._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[e._v("date")]),e._v(" -d "),n("span",{pre:!0,attrs:{class:"token string"}},[e._v("'TZ=\"America/Port-au-Prince\" 2014-10-04 18:45'")]),e._v("\ndimanche "),n("span",{pre:!0,attrs:{class:"token number"}},[e._v("5")]),e._v(" octobre "),n("span",{pre:!0,attrs:{class:"token number"}},[e._v("2014")]),e._v(", 06:45:00 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("UTC+0800"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n")])])]),n("p",[e._v("Ref: "),n("a",{attrs:{href:"http://www.ixany.org/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Documentations informatiques"),n("OutboundLink")],1),e._v(")")])])}),[],!1,null,null,null);a.default=r.exports}}]);